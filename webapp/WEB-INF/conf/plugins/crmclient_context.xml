<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd">
	
	<!-- Signature elements -->
	<util:list id="crmclient.signatureElements">
		<value>id_demand_type</value>
		<value>id_demand</value>
		<value>id_crm_user</value>
		<value>user_guid</value>
		<value>id_status_crm</value>
	</util:list>
	
	<!-- DAO -->
	<bean id="crmclient.crmItemQueueDAO" class="fr.paris.lutece.plugins.crmclient.business.CRMItemQueueDAO"/>
	
	<!-- Web Service -->
	<bean id="crmclient.webServiceCaller" class="fr.paris.lutece.plugins.crmclient.util.http.WebServiceCaller" />
    <bean id="crmclient.crmClientWebService" class="fr.paris.lutece.plugins.crmclient.service.CRMClientWebService">
    	<property name="webServiceCaller" ref="crmclient.webServiceCaller" />
    	<property name="signatureElements" ref="crmclient.signatureElements" />
    </bean>

	<!-- Services -->
	<bean id="crmclient.crmClientQueue" class="fr.paris.lutece.plugins.crmclient.service.queue.DatabaseQueue" />
	<bean id="crmclient.crmClientService" class="fr.paris.lutece.plugins.crmclient.service.CRMClientService">
		<property name="cRMClientQueue" ref="crmclient.crmClientQueue" />
		<property name="cRMClientWebService" ref="crmclient.crmClientWebService" />
	</bean>

	<!-- SignRequest -->
    <bean id="crmclient.hashService" class="fr.paris.lutece.util.signrequest.security.Sha1HashService" />
    <bean id="crmclient.requestAuthenticator" class="fr.paris.lutece.util.signrequest.HeaderHashAuthenticator" >
        <property name="hashService" ref="crmclient.hashService" />
        <property name="signatureElements" ref="crmclient.signatureElements" />
        <property name="privateKey">
            <value>change me</value>
        </property>
    </bean>
</beans>
 	